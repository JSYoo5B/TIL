# 서로 다른 통화 더하기

이제 서로 다른 통화 간의 더하기를 구현해보자.

## 간단하게 서로 다른 통화 더하기 구현

테스트 코드를 먼저 작성하자.

```go
func TestMixedAddition(t *testing.T) {
	fiveBucks := money.NewDollar(5)
	tenFrancs := money.NewFranc(10)
	bank := money.NewBank()
	bank.AddRate("CHF", "USD", 2)
	result := bank.Reduce(fiveBucks.Plus(tenFrancs), "USD")
	assert.True(t, money.NewDollar(10).Equals(result))
}
```

책의 Java 코드에서는 타입 캐스팅에 관련된 문제가 있지만, 이건 너무 사소한 문제로 보여서 생략하겠다.

어쩔 수 없이 `Equals()`로 비교를 해야 하지만, 중간에 디버거를 통해 확인해 보면 책과 같이 `result`는 15 USD가 된다.
일단 더하기 전에 환율을 통일하게 만들자.

```go
type Money interface {
	Times(multiplier int) Money
	Equals(other any) bool
	Reduce(bank *Bank, to string) Money
	Currency() string
	getAmount() int
}

func (s *Sum) Reduce(bank *Bank, to string) Money {
    amount := s.Augend.Reduce(bank, to).getAmount() +
        s.Addend.Reduce(bank, to).getAmount()
    return newMoney(amount, to)
}
```

책의 타입 캐스팅 문제처럼 일단 `Money`에 `Expression`과 동일하게 `Reduce()` 메서드를 추가로 요구하게 변경해 주고, `Sum.Reduce()`가 환율을 통일 시킨 후 더하게 변경하자.
